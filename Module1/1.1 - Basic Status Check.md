# Lab 1.1: Basic Connection and Status Check

## Purpose
This lab introduces you to the fundamental process of connecting to a Spot robot and verifying its readiness for operations. You'll learn how to establish communication, authenticate, and check critical robot health indicators before attempting any movements or commands. Understanding these basics is essential for all future robot programming work.

## What You'll Learn
- How to create an SDK instance and robot object
- Authentication process and credential management
- Querying robot state and interpreting status information
- Implementing basic safety checks before operations
- Proper error handling for connection issues

## Prerequisites
- Spot SDK installed on your development machine
- Robot powered on and connected to your network
- Robot IP address and admin credentials
- Python 3.6 or higher

## Tasks to Complete

### Task 1: Environment Setup
1. Create a new Python file named `lab1_1_connection.py`
2. Import the required Boston Dynamics SDK modules (see code example)
3. Replace the placeholder IP address with your robot's actual IP
4. Store your robot credentials in environment variables for security:
   ```bash
   export BOSDYN_CLIENT_USERNAME=your_username
   export BOSDYN_CLIENT_PASSWORD=your_password
   ```

### Task 2: Implement Connection Function
1. Complete the `connect_to_robot()` function
2. Add proper exception handling for connection failures
3. Implement timeout logic (suggest 10 seconds maximum)
4. Test connection with your robot and verify successful authentication
5. Print confirmation message with robot's serial number upon successful connection

### Task 3: Health Status Verification
1. Implement the `check_robot_status()` function to retrieve robot state
2. Extract and display the following information:
   - Battery percentage
   - Battery charging status
   - Robot software version
   - Current power state
   - Any active faults or warnings
3. Create a boolean function `is_robot_ready()` that returns True only if:
   - Battery level is above 20%
   - No critical faults are present
   - Robot is not currently charging

### Task 4: Enhanced Status Display
1. Format the status output in a user-friendly way
2. Add color coding (using a library like `colorama`) for:
   - Green: Battery > 50%
   - Yellow: Battery 20-50%
   - Red: Battery < 20%
3. Display estimated remaining runtime based on battery level

### Task 5: Error Handling and Logging
1. Implement try-except blocks for all SDK calls
2. Create meaningful error messages for common failures:
   - Network timeout
   - Authentication failure
   - Robot not responding
3. Log all connection attempts to a file `connection_log.txt` with timestamps
4. Add a retry mechanism that attempts connection 3 times before failing

## Deliverables
- [ ] Working `lab1_1_connection.py` script that successfully connects to your robot
- [ ] Screenshot or terminal output showing successful connection and status display
- [ ] Documentation of any errors encountered and how you resolved them
- [ ] Brief written reflection (3-5 sentences) on what you learned about robot connection management

## Testing Checklist
- [ ] Script runs without errors when robot is available
- [ ] Appropriate error messages display when robot is unreachable
- [ ] Battery status displays correctly
- [ ] Script refuses to proceed if battery is critically low
- [ ] Connection retry logic works as expected

## Common Issues and Hints
- If authentication fails, verify your credentials are correct and have admin privileges
- If connection times out, check that your computer and robot are on the same network
- Robot IP may change if using DHCP; consider setting a static IP
- The first connection may take longer as the SDK syncs time with the robot

## Code Example Reference

```python
import bosdyn.client
from bosdyn.client.robot_state import RobotStateClient
from bosdyn.client.lease import LeaseClient
import time

def connect_to_robot(hostname):
    """Connect to robot and return authenticated robot object"""
    sdk = bosdyn.client.create_standard_sdk('inspection-demo')
    robot = sdk.create_robot(hostname)
    
    # Authenticate with robot
    bosdyn.client.util.authenticate(robot)
    
    # Verify robot is ready
    robot.sync_time_with_robot()
    
    return robot

def check_robot_status(robot):
    """Check basic robot health and battery"""
    state_client = robot.ensure_client(RobotStateClient.default_service_name)
    robot_state = state_client.get_robot_state()
    
    # Check battery level
    battery_state = robot_state.battery_states[0]
    battery_percent = battery_state.charge_percentage.value
    
    print(f"Battery: {battery_percent:.1f}%")
    print(f"Robot ID: {robot_state.status.robot_id}")
    
    return battery_percent > 20  # Minimum battery check

# Main execution
if __name__ == "__main__":
    robot = connect_to_robot("192.168.80.3")  # Replace with your robot's IP
    
    if check_robot_status(robot):
        print("Robot ready for inspection!")
    else:
        print("Robot not ready - check battery or status")
```

## Grading Rubric
- **Functionality** (40%): Does the code work as specified?
- **Code Quality** (20%): Is the code well-organized and documented?
- **Safety** (20%): Are proper safety measures implemented?
- **Completeness** (20%): Are all deliverables submitted?

## Getting Help
- Review the code examples provided in the module materials
- Check Boston Dynamics SDK documentation: https://dev.bostondynamics.com
- Post questions in the course forum (include error messages and what you've tried)
- Attend office hours for hands-on assistance
- Remember: Struggling with problems is part of the learning process!
